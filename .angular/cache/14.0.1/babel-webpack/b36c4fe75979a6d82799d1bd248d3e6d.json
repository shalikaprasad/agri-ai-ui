{"ast":null,"code":"import { Validators } from '@angular/forms';\nimport { first } from 'rxjs/operators';\nimport { User } from 'projects/administration/src/app/shared/models/User';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"projects/tools/src/lib/user.service\";\nimport * as i4 from \"projects/tools/src/lib/alert.service\";\nimport * as i5 from \"projects/tools/src/lib/file.service\";\nimport * as i6 from \"@angular/common\";\n\nfunction UpdateProfileComponent_option_29_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 41);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const role_r4 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", role_r4);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(role_r4);\n  }\n}\n\nfunction UpdateProfileComponent_div_74_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" Upload progress: \", ctx_r1.fileUploadProgress, \" \");\n  }\n}\n\nfunction UpdateProfileComponent_div_75_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 42);\n    i0.ɵɵelement(1, \"img\", 43);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate(\"src\", ctx_r2.previewUrl, i0.ɵɵsanitizeUrl);\n  }\n}\n\nfunction UpdateProfileComponent_div_76_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 44);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r3.uploadedFilePath, \" \");\n  }\n}\n\nexport let UpdateProfileComponent = /*#__PURE__*/(() => {\n  class UpdateProfileComponent {\n    constructor(formBuilder, route, router, userService, alertService, actRoute, fileService) {\n      this.formBuilder = formBuilder;\n      this.route = route;\n      this.router = router;\n      this.userService = userService;\n      this.alertService = alertService;\n      this.actRoute = actRoute;\n      this.fileService = fileService;\n      this.loading = false;\n      this.submitted = false;\n      this.user = new User();\n      this.roleTypeList = ['Select Role Type', 'Administrator', 'Officer', 'User'];\n      this.fileData = null;\n      this.previewUrl = null;\n      this.fileUploadProgress = null;\n      this.uploadedFilePath = null;\n\n      this.handleError = (controlName, errorName) => {\n        return this.createUserForm.controls[controlName].hasError(errorName);\n      };\n\n      this.baseImagePath = fileService.getImageBasePath() + 'user';\n      this.userId = this.actRoute.snapshot.params.id;\n\n      if (this.userId !== undefined) {\n        const updatedUser = JSON.parse(localStorage.getItem('updateUser'));\n\n        if (updatedUser.id.toString() === this.userId) {\n          this.user = updatedUser;\n          this.previewUrl = this.baseImagePath + '/' + this.user.imageFileName;\n        } else {\n          this.user = new User();\n        }\n      }\n    } // convenience getter for easy access to form fields\n\n\n    get f() {\n      return this.createUserForm.controls;\n    }\n\n    ngOnInit() {\n      let roles;\n\n      if (this.user.roles !== undefined) {\n        roles = this.user.roles[0]['name'];\n        this.user.password = null;\n      } else {\n        roles = 'Select Role Type';\n      }\n\n      this.createUserForm = this.formBuilder.group({\n        branchId: [this.user.branchId, [Validators.required]],\n        branchName: [this.user.branchName, [Validators.required]],\n        address: [this.user.address, []],\n        phoneNumber: [this.user.phoneNumber, []],\n        userName: [this.user.userName, [Validators.required]],\n        password: [this.user.password, [Validators.required]],\n        email: [this.user.email, [Validators.required]],\n        roles: [roles, []],\n        fileData: [''],\n        isAgree: ['', []]\n      });\n    }\n\n    fileProgress(fileInput) {\n      this.fileData = fileInput.target.files[0];\n      this.preview();\n    }\n\n    preview() {\n      // Show preview\n      const mimeType = this.fileData.type;\n\n      if (mimeType.match(/image\\/*/) == null) {\n        return;\n      }\n\n      const reader = new FileReader();\n      reader.readAsDataURL(this.fileData);\n\n      reader.onload = _event => {\n        this.previewUrl = reader.result;\n      };\n    }\n\n    onSubmitUser() {\n      this.submitted = true; // reset alerts on submit\n\n      this.alertService.clear(); // stop here if form is invalid\n\n      if (this.createUserForm.invalid) {\n        return;\n      }\n\n      this.loading = true;\n      this.user.branchId = this.f.branchId.value;\n      this.user.branchName = this.f.branchName.value;\n      this.user.address = this.f.address.value;\n      this.user.phoneNumber = this.f.phoneNumber.value;\n      this.user.userName = this.f.userName.value;\n      this.user.password = this.f.password.value;\n      this.user.email = this.f.email.value;\n      this.user.roles = this.f.roles.value;\n      this.user.fileData = this.fileData;\n      this.isAgree = this.f.isAgree.value;\n      this.fileService.uploadImage(this.user.fileData, 'user').pipe(first()).subscribe(data => {\n        const bodyData1 = data['body']['0'];\n        const bodyData2 = data['body']['1'];\n        this.user.pictureId = bodyData1.id;\n        this.user.imageName = bodyData1.imageName;\n        this.user.imageFileName = bodyData1.imageFileName;\n        this.user.thumbnail = bodyData2.thumbnail;\n        this.user.imageFile = bodyData2.imageFile;\n        this.userService.updateUser(this.user).pipe(first()).subscribe(data => {\n          this.router.navigate(['/dashboard/profile']);\n        }, error => {\n          this.alertService.error(error);\n          this.loading = false;\n        });\n      }, error => {\n        this.alertService.error(error);\n        this.loading = false;\n      });\n    }\n\n  }\n\n  UpdateProfileComponent.ɵfac = function UpdateProfileComponent_Factory(t) {\n    return new (t || UpdateProfileComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.ActivatedRoute), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i3.UserService), i0.ɵɵdirectiveInject(i4.AlertService), i0.ɵɵdirectiveInject(i2.ActivatedRoute), i0.ɵɵdirectiveInject(i5.FileService));\n  };\n\n  UpdateProfileComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: UpdateProfileComponent,\n    selectors: [[\"app-update-profile\"]],\n    decls: 88,\n    vars: 5,\n    consts: [[1, \"container\", \"my-4\"], [\"href\", \"https:google.com\", \"target\", \"_blank\"], [1, \"my-4\"], [1, \"mb-5\", \"h4\"], [\"novalidate\", \"\", 1, \"needs-validation\", 3, \"formGroup\", \"ngSubmit\"], [1, \"form-row\"], [1, \"col-md-4\", \"mb-3\"], [\"for\", \"validationBranchId\"], [\"type\", \"text\", \"id\", \"validationBranchId\", \"placeholder\", \"Branch ID\", \"formControlName\", \"branchId\", 1, \"form-control\"], [1, \"valid-feedback\"], [\"for\", \"validationBranchName\"], [\"type\", \"text\", \"id\", \"validationBranchName\", \"placeholder\", \"Branch Name\", \"formControlName\", \"branchName\", 1, \"form-control\"], [\"for\", \"validationRoleType\"], [\"formControlName\", \"roles\", \"id\", \"validationRoleType\", \"required\", \"\", 1, \"form-control\", \"selectpicker\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"for\", \"validationPhoneNumber\"], [\"type\", \"text\", \"id\", \"validationPhoneNumber\", \"placeholder\", \"Phone Number\", \"formControlName\", \"phoneNumber\", 1, \"form-control\"], [\"for\", \"validationUserName\"], [1, \"input-group\"], [1, \"input-group-prepend\"], [\"id\", \"inputGroupPrepend\", 1, \"input-group-text\"], [\"type\", \"text\", \"id\", \"validationUserName\", \"placeholder\", \"User Name\", \"formControlName\", \"userName\", \"aria-describedby\", \"inputGroupPrepend\", 1, \"form-control\"], [\"for\", \"validationPassword\"], [\"type\", \"text\", \"id\", \"validationPassword\", \"placeholder\", \"Password\", \"formControlName\", \"password\", 1, \"form-control\"], [\"for\", \"validationEmail\"], [\"type\", \"text\", \"id\", \"validationEmail\", \"placeholder\", \"Email\", \"formControlName\", \"email\", 1, \"form-control\"], [1, \"col-md-8\", \"mb-3\"], [\"for\", \"validationAddress\"], [\"type\", \"text\", \"id\", \"validationAddress\", \"placeholder\", \"Address\", \"formControlName\", \"address\", 1, \"form-control\"], [1, \"col-md-12\", \"mb-3\"], [\"for\", \"validationPictureUrl\"], [\"type\", \"file\", \"name\", \"image\", \"id\", \"validationPictureUrl\", \"formControlName\", \"fileData\", 3, \"change\"], [4, \"ngIf\"], [\"class\", \"image-preview mb-3\", 4, \"ngIf\"], [\"class\", \"mb-3\", 4, \"ngIf\"], [1, \"form-group\", 2, \"padding-top\", \"10px\"], [1, \"custom-control\", \"custom-checkbox\"], [\"type\", \"checkbox\", \"id\", \"invalidCheck\", \"formControlName\", \"isAgree\", 1, \"custom-control-input\"], [\"for\", \"invalidCheck\", 1, \"custom-control-label\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\", 2, \"margin-right\", \"15px\"], [\"routerLink\", \"/dashboard/profile\", 1, \"btn\", \"btn-danger\"], [3, \"value\"], [1, \"image-preview\", \"mb-3\"], [\"height\", \"300\", 3, \"src\"], [1, \"mb-3\"]],\n    template: function UpdateProfileComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"h2\");\n        i0.ɵɵtext(1, \"Create or Update Farmer\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(2, \"div\", 0)(3, \"p\")(4, \"strong\");\n        i0.ɵɵtext(5, \"If you want to add farmer our web site, Please fill this form correctly. Because, It will add to Machine Learning System. So, If you enter wrong details prediction will be wrong. \");\n        i0.ɵɵelementStart(6, \"a\", 1);\n        i0.ɵɵtext(7, \"If you want more details. click here...\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelement(8, \"hr\", 2);\n        i0.ɵɵelementStart(9, \"h4\", 3);\n        i0.ɵɵtext(10, \"Project Creation Form\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(11, \"form\", 4);\n        i0.ɵɵlistener(\"ngSubmit\", function UpdateProfileComponent_Template_form_ngSubmit_11_listener() {\n          return ctx.onSubmitUser();\n        });\n        i0.ɵɵelementStart(12, \"div\", 5)(13, \"div\", 6)(14, \"label\", 7);\n        i0.ɵɵtext(15, \"Branch ID\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(16, \"input\", 8);\n        i0.ɵɵelementStart(17, \"div\", 9);\n        i0.ɵɵtext(18, \" Looks good! \");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(19, \"div\", 6)(20, \"label\", 10);\n        i0.ɵɵtext(21, \"Branch Name\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(22, \"input\", 11);\n        i0.ɵɵelementStart(23, \"div\", 9);\n        i0.ɵɵtext(24, \" Looks good! \");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(25, \"div\", 6)(26, \"label\", 12);\n        i0.ɵɵtext(27, \"Role Type\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(28, \"select\", 13);\n        i0.ɵɵtemplate(29, UpdateProfileComponent_option_29_Template, 2, 2, \"option\", 14);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(30, \"div\", 9);\n        i0.ɵɵtext(31, \" Looks good! \");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(32, \"div\", 5)(33, \"div\", 6)(34, \"label\", 15);\n        i0.ɵɵtext(35, \"Phone Number\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(36, \"input\", 16);\n        i0.ɵɵelementStart(37, \"div\", 9);\n        i0.ɵɵtext(38, \" Looks good! \");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(39, \"div\", 6)(40, \"label\", 17);\n        i0.ɵɵtext(41, \"User Name\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(42, \"div\", 18)(43, \"div\", 19)(44, \"span\", 20);\n        i0.ɵɵtext(45, \"@\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelement(46, \"input\", 21);\n        i0.ɵɵelementStart(47, \"div\", 9);\n        i0.ɵɵtext(48, \" Looks good! \");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(49, \"div\", 6)(50, \"label\", 22);\n        i0.ɵɵtext(51, \"Password\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(52, \"input\", 23);\n        i0.ɵɵelementStart(53, \"div\", 9);\n        i0.ɵɵtext(54, \" Looks good! \");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(55, \"div\", 5)(56, \"div\", 6)(57, \"label\", 24);\n        i0.ɵɵtext(58, \"Email\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(59, \"input\", 25);\n        i0.ɵɵelementStart(60, \"div\", 9);\n        i0.ɵɵtext(61, \" Looks good! \");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(62, \"div\", 26)(63, \"label\", 27);\n        i0.ɵɵtext(64, \"Address\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(65, \"input\", 28);\n        i0.ɵɵelementStart(66, \"div\", 9);\n        i0.ɵɵtext(67, \" Looks good! \");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(68, \"div\", 5)(69, \"div\", 29)(70, \"label\", 30);\n        i0.ɵɵtext(71, \"Picture Url\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(72, \"br\");\n        i0.ɵɵelementStart(73, \"input\", 31);\n        i0.ɵɵlistener(\"change\", function UpdateProfileComponent_Template_input_change_73_listener($event) {\n          return ctx.fileProgress($event);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(74, UpdateProfileComponent_div_74_Template, 2, 1, \"div\", 32);\n        i0.ɵɵtemplate(75, UpdateProfileComponent_div_75_Template, 2, 1, \"div\", 33);\n        i0.ɵɵtemplate(76, UpdateProfileComponent_div_76_Template, 2, 1, \"div\", 34);\n        i0.ɵɵelementStart(77, \"div\", 9);\n        i0.ɵɵtext(78, \" Looks good! \");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(79, \"div\", 35)(80, \"div\", 36);\n        i0.ɵɵelement(81, \"input\", 37);\n        i0.ɵɵelementStart(82, \"label\", 38);\n        i0.ɵɵtext(83, \"Are You agree to add Farmer?\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(84, \"button\", 39);\n        i0.ɵɵtext(85, \"Update User\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(86, \"button\", 40);\n        i0.ɵɵtext(87, \"Cancel Update\");\n        i0.ɵɵelementEnd()()();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(11);\n        i0.ɵɵproperty(\"formGroup\", ctx.createUserForm);\n        i0.ɵɵadvance(18);\n        i0.ɵɵproperty(\"ngForOf\", ctx.roleTypeList);\n        i0.ɵɵadvance(45);\n        i0.ɵɵproperty(\"ngIf\", ctx.fileUploadProgress);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.previewUrl);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.uploadedFilePath);\n      }\n    },\n    dependencies: [i6.NgForOf, i6.NgIf, i2.RouterLink, i1.ɵNgNoValidate, i1.NgSelectOption, i1.ɵNgSelectMultipleOption, i1.DefaultValueAccessor, i1.CheckboxControlValueAccessor, i1.SelectControlValueAccessor, i1.NgControlStatus, i1.NgControlStatusGroup, i1.RequiredValidator, i1.FormGroupDirective, i1.FormControlName]\n  });\n  return UpdateProfileComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}